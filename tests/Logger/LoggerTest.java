package Logger;

import org.junit.jupiter.api.Test;

import java.io.File;
import java.io.FileNotFoundException;
import java.util.Scanner;

import static org.junit.jupiter.api.Assertions.*;

class LoggerTest {

    @Test
    void log() {
        String s = "T1";
        String s2 = "T2";
        Logger logger = new Logger(".\\data\\log.txt");
        logger.log(s);
        logger.log(s2);
        File file = new File(".\\data\\log.txt");
        try {
            Scanner scanner = new Scanner(file);
            String line = scanner.nextLine();
            assertEquals(s+s2, line);
        } catch (FileNotFoundException e) {
            throw new RuntimeException(e);
        }

    }

    @Test
    void validateLog() {
        String regex = "((T1)((T2)(.*?)(T4)(.*?)|(T3)(.*?)(T5)(.*?))(T6))|((T7)(T8)(T9)(T10))";
        String replace = "$5$7$9$11";
        Logger logger = new Logger(".\\data\\log.txt");
        logger.log("T1T3T7T8T5T6T9T10T7T8T9T10T1T3T1T2T5T6T1T3T7T8T9T10T4T6T5T6T7T8T9T10T1T3T5T6T1T3T1T2T5T6T4T6T7T8T9T10T1T2T1T3T7T8T4T6T5T6T9T10T1T3T7T8T9T10T7T8T9T10T7T8T5T6T9T10T7T8T9T10T1T3T1T2T5T6T1T3T7T8T9T10T5T6T4T6T1T3T5T6T1T2T7T8T4T6T9T10T7T8T9T10T7T8T9T10T1T3T1T2T5T6T1T3T4T6T7T8T5T6T9T10T1T3T7T8T5T6T9T10T7T8T9T10T7T8T9T10T7T8T9T10T7T8T9T10T1T3T1T2T4T6T1T2T7T8T9T10T4T6T7T8T5T6T9T10T7T8T9T10T7T8T9T10T7T8T9T10T1T3T1T2T5T6T4T6T1T2T1T3T5T6T7T8T4T6T9T10T1T2T1T3T4T6T5T6T1T2T7T8T4T6T9T10T1T2T4T6T1T2T1T3T7T8T9T10T5T6T7T8T4T6T9T10T7T8T9T10T1T2T7T8T4T6T9T10T1T2T1T3T5T6T1T3T4T6T1T2T4T6T1T2T5T6T7T8T9T10T4T6T7T8T9T10T7T8T9T10T1T2T4T6T7T8T9T10T1T2T4T6T1T3T5T6T1T2T7T8T4T6T9T10T1T2T1T3T4T6T5T6T7T8T9T10T7T8T9T10T7T8T9T10T1T2T7T8T4T6T9T10T7T8T9T10T7T8T9T10T7T8T9T10T1T3T5T6T7T8T9T10T7T8T9T10T7T8T9T10T1T3T1T2T7T8T4T6T5T6T9T10T1T3T7T8T9T10T7T8T9T10T5T6T7T8T9T10T1T3T5T6T7T8T9T10T7T8T9T10T7T8T9T10T7T8T9T10T7T8T9T10T1T2T4T6T1T3T5T6T1T2T1T3T4T6T5T6T7T8T9T10T1T3T7T8T9T10T5T6T7T8T9T10T1T3T5T6T7T8T9T10T1T3T5T6T1T2T4T6T1T2T1T3T4T6T5T6T7T8T9T10T1T2T1T3T7T8T4T6T9T10T1T2T7T8T4T6T9T10T5T6T7T8T9T10T7T8T9T10T1T3T7T8T5T6T9T10T7T8T9T10T1T2T1T3T7T8T9T10T7T8T5T6T9T10T1T3T4T6T5T6T1T2T7T8T9T10T7T8T4T6T9T10T7T8T9T10T1T3T7T8T5T6T9T10T7T8T9T10T1T2T1T3T4T6T5T6T7T8T9T10T7T8T9T10T7T8T9T10T7T8T9T10T7T8T9T10T1T2T4T6T1T3T1T2T5T6T1T3T5T6T7T8T4T6T9T10T7T8T9T10T7T8T9T10T7T8T9T10T1T3T5T6T1T2T1T3T7T8T9T10T4T6T7T8T9T10T5T6T7T8T9T10T7T8T9T10T1T2T7T8T4T6T9T10T1T2T7T8T9T10T7T8T4T6T9T10T1T2T7T8T9T10T1T3T4T6T1T2T7T8T5T6T9T10T7T8T4T6T9T10T1T2T7T8T9T10T7T8T9T10T1T3T4T6T7T8T5T6T9T10T7T8T9T10T1T3T7T8T9T10T7T8T9T10T1T2T7T8T5T6T9T10T7T8T9T10T1T3T7T8T9T10T4T6T7T8T9T10T7T8T5T6T9T10T7T8T9T10T1T3T1T2T7T8T9T10T4T6T1T2T5T6T7T8T9T10T7T8T4T6T9T10T7T8T9T10T7T8T9T10T1T3T1T2T5T6T1T3T5T6T7T8T4T6T9T10T7T8T9T10T1T2T1T3T7T8T9T10T5T6T4T6T1T2T4T6T7T8T9T10T1T2T4T6T7T8T9T10T7T8T9T10T7T8T9T10T1T2T4T6T1T3T7T8T9T10T1T2T4T6T7T8T5T6T9T10T1T3T7T8T5T6T9T10T1T2T1T3T7T8T9T10T7T8T9T10T4T6T1T2T4T6T1T2T4T6T1T2T5T6T4T6T1T2T7T8T9T10T7T8T4T6T9T10T1T2T7T8T4T6T9T10T1T3T7T8T9T10T1T2T5T6T4T6T1T2T1T3T5T6T4T6T1T2T7T8T9T10T1T3T4T6T7T8T9T10T5T6T1T2T7T8T4T6T9T10T7T8T9T10T7T8T9T10T7T8T9T10T1T2T7T8T4T6T9T10T1T2T4T6");
        boolean isValid = logger.validateLog(regex,replace);
        assertTrue(isValid);


        // 1000 invariantes de RDP del TP2
        regex = "T0(?<T0>(?:T(?:\\d+))*?)(?:(?:T1(?<T1>(?:T(?:\\d+))*?)T3)|(?:T2(?<T2>(?:T(?:\\d+))*?)T4))(?<T3T4>(?:T(?:\\d+))*?)(?:(?:T5(?<T5>(?:T(?:\\d+))*?)T7)|(?:T6(?<T6>(?:T(?:\\d+))*?)T8))(?<T7T8>(?:T(?:\\d+))*?)(?:(?:T10(?<T10>(?:T(?:\\d+))*?)T12)|(?:T9(?<T9>(?:T(?:\\d+))*?)T11))(?<T11T12>(?:T(?:\\d+))*?)T13(?<T13>(?:T(?:\\d+))*?)T14(?<T14>(?:T(?:\\d+))*?)";
        replace = "${T0}${T1}${T2}${T3T4}${T5}${T6}${T7T8}${T9}${T10}${T11T12}${T13}${T14}";
        logger = new Logger(".\\data\\log.txt");
        logger.log("T0T1T3T6T0T1T0T2T8T9T3T5T4T6T0T2T11T13T14T0T1T0T4T2T3T4T0T2T4T7T9T5T0T1T8T6T0T2T3T4T8T6T11T9T13T11T10T0T1T8T6T7T5T12T10T14T13T12T9T14T13T14T13T14T11T13T8T10T6T0T2T14T4T0T2T12T13T7T5T10T4T14T8T6T12T9T13T14T8T11T13T10T0T2T3T6T14T12T13T14T4T0T2T7T10T5T0T1T4T0T2T12T13T4T0T2T0T14T4T2T3T0T1T0T0T4T2T0T4T2T3T1T8T10T6T12T13T14T4T3T0T1T0T2T4T3T8T10T6T12T13T14T8T10T6T8T6T12T13T9T8T6T11T9T0T1T11T3T14T13T14T13T14T8T9T6T11T13T14T0T2T4T0T1T7T10T5T8T6T3T12T10T13T14T12T13T8T6T10T14T0T2T0T1T7T5T4T0T2T12T9T13T4T7T5T0T2T3T4T14T11T10T13T8T6T14T7T5T7T5T0T1T8T6T0T2T7T5T12T9T13T14T11T13T10T4T0T2T12T10T12T9T14T13T8T6T3T4T14T13T14T0T1T7T5T11T9T13T3T11T9T11T9T0T2T11T0T1T4T3T0T1T14T13T14T13T8T10T6T14T13T0T2T8T6T14T8T6T12T13T10T3T4T7T5T14T12T10T13T12T10T14T13T0T1T7T5T14T3T12T9T13T0T2T0T1T14T3T11T13T14T0T1T4T8T6T10T3T12T13T7T10T5T7T5T14T12T9T13T14T11T13T0T1T8T6T9T14T0T2T11T13T0T0T3T1T14T4T2T0T4T2T3T7T9T5T8T6T11T13T9T11T4T14T13T0T1T14T3T0T1T0T2T3T7T9T5T0T1T11T13T8T9T6T11T0T14T13T4T2T4T0T2T4T3T0T2T4T0T2T4T14T8T6T9T11T13T8T6T10T12T7T10T5T12T14T13T14T13T8T9T6T11T0T2T4T14T13T0T1T0T2T4T3T14T0T1T0T2T3T4T7T10T5T12T13T14T8T9T6T11T13T0T1T14T3T0T1T0T2T4T3T8T10T6T12T13T14T0T1T3T0T2T7T9T5T0T1T11T13T14T0T8T10T6T4T2T4T12T13T14T8T6T9T11T13T0T2T3T14T4T7T9T5T11T13T8T10T6T14T12T13T7T5T9T11T8T6T10T12T14T13T14T13T14T7T10T5T8T6T8T6T8T6T12T13T9T11T10T12T10T14T13T12T14T13T7T10T5T12T14T13T0T1T14T13T3T14T0T1T0T2T3T8T9T6T11T13T0T1T4T0T2T4T0T2T14T7T9T5T4T3T11T13T8T10T6T14T8T6T12T10T13T14T12T13T0T1T14T3T8T10T6T0T2T12T13T0T1T4T7T10T5T14T12T13T14T0T2T4T3T0T2T4T0T2T0T1T0T4T2T3T4T8T6T10T0T1T12T13T8T6T10T14T12T13T14T3T7T10T5T0T2T0T1T4T12T13T14T8T10T6T12T13T3T14T8T9T6T11T13T7T10T5T14T12T13T0T2T8T6T10T12T4T14T13T7T5T9T14T11T13T14T0T2T8T10T6T12T13T4T14T0T2T4T0T1T7T5T9T8T6T3T11T9T13T11T14T13T14T8T10T6T7T5T0T1T0T2T4T12T9T13T14T11T13T3T14T7T10T5T12T13T14T0T2T7T10T5T7T5T8T6T12T9T13T11T9T14T13T8T6T14T4T11T13T10T14T12T13T14T8T6T9T11T13T14T8T10T6T7T5T12T9T13T14T11T13T14T8T9T6T8T6T11T10T13T14T7T5T0T1T3T7T5T12T10T13T12T10T14T13T0T1T7T12T10T14T13T14T12T13T8T9T0T2T14T11T13T3T5T4T6T0T1T7T10T8T14T12T13T9T11T14T13T14T0T2T4T6T3T5T0T2T4T0T1T0T2T7T10T5T12T13T4T14T8T10T6T7T0T2T12T9T13T0T14T3T1T5T3T4T0T1T3T0T2T7T5T11T13T10T12T14T13T4T14T0T2T0T1T0T4T2T7T10T5T8T6T8T6T4T3T0T1T0T2T12T13T9T4T0T2T3T8T6T4T11T10T14T13T0T2T14T12T10T13T12T4T14T13T0T2T4T14T7T10T5T12T13T14T0T2T0T1T4T3T8T9T6T11T13T14T0T1T3T7T9T5T0T1T7T5T11T10T13T14T12T13T0T2T4T3T8T6T9T11T14T13T14T8T9T6T8T6T7T5T8T6T7T5T8T6T7T5T8T7T11T13T10T12T10T12T9T11T10T14T13T14T13T14T13T14T12T13T10T12T9T11T10T12T9T11T14T13T14T13T14T13T14T13T14");
        isValid = logger.validateLog(regex,replace);
        assertTrue(isValid);

        // pongo transicion incorrecta en el log
        regex = "T0(?<T0>(?:T(?:\\d+))*?)(?:(?:T1(?<T1>(?:T(?:\\d+))*?)T3)|(?:T2(?<T2>(?:T(?:\\d+))*?)T4))(?<T3T4>(?:T(?:\\d+))*?)(?:(?:T5(?<T5>(?:T(?:\\d+))*?)T7)|(?:T6(?<T6>(?:T(?:\\d+))*?)T8))(?<T7T8>(?:T(?:\\d+))*?)(?:(?:T10(?<T10>(?:T(?:\\d+))*?)T12)|(?:T9(?<T9>(?:T(?:\\d+))*?)T11))(?<T11T12>(?:T(?:\\d+))*?)T13(?<T13>(?:T(?:\\d+))*?)T14(?<T14>(?:T(?:\\d+))*?)";
        replace = "${T0}${T1}${T2}${T3T4}${T5}${T6}${T7T8}${T9}${T10}${T11T12}${T13}${T14}";
        logger = new Logger(".\\data\\log.txt");
        logger.log("T0T1T3T6T0T1T0T2T8T9T3T5T4T6T0T2T11T13T14T0T1T0T4T2T3T4T0T2T4T7T9T5T0T1T8T6T0T2T3T4T8T6T11T9T13T11T10T0T1T8T6T7T5T12T10T14T13T12T9T14T13T14T13T14T11T13T8T10T6T0T2T14T4T0T2T12T13T7T5T10T4T14T8T6T12T9T13T14T8T11T13T10T0T2T3T6T14T12T13T14T4T0T2T7T10T5T0T1T4T0T2T12T13T4T0T2T0T14T4T2T3T0T1T0T0T4T2T0T4T2T3T1T8T10T6T12T13T14T4T3T0T1T0T2T4T3T8T10T6T12T13T14T8T10T6T8T6T12T13T9T8T6T11T9T0T1T11T3T14T13T14T13T14T8T9T6T11T13T14T0T2T4T0T1T7T10T5T8T6T3T12T10T13T14T12T13T8T6T10T14T0T2T0T1T7T5T4T0T2T12T9T13T4T7T5T0T2T3T4T14T11T10T13T8T6T14T7T5T7T5T0T1T8T6T0T2T7T5T12T9T13T14T11T13T10T4T0T2T12T10T12T9T14T13T8T6T3T4T14T13T14T0T1T7T5T11T9T13T3T11T9T11T9T0T2T11T0T1T4T3T0T1T14T13T14T13T8T10T6T14T13T0T2T8T6T14T8T6T12T13T10T3T4T7T5T14T12T10T13T12T10T10T14T13T0T1T7T5T14T3T12T9T13T0T2T0T1T14T3T11T13T14T0T1T4T8T6T10T3T12T13T7T10T5T7T5T14T12T9T13T14T11T13T0T1T8T6T9T14T0T2T11T13T0T0T3T1T14T4T2T0T4T2T3T7T9T5T8T6T11T13T9T11T4T14T13T0T1T14T3T0T1T0T2T3T7T9T5T0T1T11T13T8T9T6T11T0T14T13T4T2T4T0T2T4T3T0T2T4T0T2T4T14T8T6T9T11T13T8T6T10T12T7T10T5T12T14T13T14T13T8T9T6T11T0T2T4T14T13T0T1T0T2T4T3T14T0T1T0T2T3T4T7T10T5T12T13T14T8T9T6T11T13T0T1T14T3T0T1T0T2T4T3T8T10T6T12T13T14T0T1T3T0T2T7T9T5T0T1T11T13T14T0T8T10T6T4T2T4T12T13T14T8T6T9T11T13T0T2T3T14T4T7T9T5T11T13T8T10T6T14T12T13T7T5T9T11T8T6T10T12T14T13T14T13T14T7T10T5T8T6T8T6T8T6T12T13T9T11T10T12T10T14T13T12T14T13T7T10T5T12T14T13T0T1T14T13T3T14T0T1T0T2T3T8T9T6T11T13T0T1T4T0T2T4T0T2T14T7T9T5T4T3T11T13T8T10T6T14T8T6T12T10T13T14T12T13T0T1T14T3T8T10T6T0T2T12T13T0T1T4T7T10T5T14T12T13T14T0T2T4T3T0T2T4T0T2T0T1T0T4T2T3T4T8T6T10T0T1T12T13T8T6T10T14T12T13T14T3T7T10T5T0T2T0T1T4T12T13T14T8T10T6T12T13T3T14T8T9T6T11T13T7T10T5T14T12T13T0T2T8T6T10T12T4T14T13T7T5T9T14T11T13T14T0T2T8T10T6T12T13T4T14T0T2T4T0T1T7T5T9T8T6T3T11T9T13T11T14T13T14T8T10T6T7T5T0T1T0T2T4T12T9T13T14T11T13T3T14T7T10T5T12T13T14T0T2T7T10T5T7T5T8T6T12T9T13T11T9T14T13T8T6T14T4T11T13T10T14T12T13T14T8T6T9T11T13T14T8T10T6T7T5T12T9T13T14T11T13T14T8T9T6T8T6T11T10T13T14T7T5T0T1T3T7T5T12T10T13T12T10T14T13T0T1T7T12T10T14T13T14T12T13T8T9T0T2T14T11T13T3T5T4T6T0T1T7T10T8T14T12T13T9T11T14T13T14T0T2T4T6T3T5T0T2T4T0T1T0T2T7T10T5T12T13T4T14T8T10T6T7T0T2T12T9T13T0T14T3T1T5T3T4T0T1T3T0T2T7T5T11T13T10T12T14T13T4T14T0T2T0T1T0T4T2T7T10T5T8T6T8T6T4T3T0T1T0T2T12T13T9T4T0T2T3T8T6T4T11T10T14T13T0T2T14T12T10T13T12T4T14T13T0T2T4T14T7T10T5T12T13T14T0T2T0T1T4T3T8T9T6T11T13T14T0T1T3T7T9T5T0T1T7T5T11T10T13T14T12T13T0T2T4T3T8T6T9T11T14T13T14T8T9T6T8T6T7T5T8T6T7T5T8T6T7T5T8T7T11T13T10T12T10T12T9T11T10T14T13T14T13T14T13T14T12T13T10T12T9T11T10T12T9T11T14T13T14T13T14T13T14T13T14");
        isValid = logger.validateLog(regex,replace);
        assertFalse(isValid);
    }
}